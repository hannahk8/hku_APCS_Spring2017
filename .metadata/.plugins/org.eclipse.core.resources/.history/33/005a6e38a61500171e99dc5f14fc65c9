package textExcel;
import java.util.Arrays;

import com.sun.xml.internal.bind.v2.runtime.unmarshaller.XsiNilLoader.Array;

public class FormulaCell extends RealCell{
	private String formulaValue;
	String calculatedValue;


	public FormulaCell(String formula) {
		setCellText(formula);
		this.formulaValue = getCellText();
	}
	
	public double getDoubleValue(){
		System.out.println(this.formulaValue);
		String[] formulaArrayValues = formulaValue.split(" "); 
		double nextNum = 0.0;
		if(formulaArrayValues.length > 3){
			for(int i = 1; i < formulaArrayValues.length - 2; i += 2){
				double currentNum = Double.parseDouble(formulaArrayValues[i]);
				nextNum = Double.parseDouble(formulaArrayValues[i + 2]);
				if(formulaArrayValues[i + 1].equals("+")){
					System.out.println(nextNum);
					System.out.println(currentNum);

					nextNum = currentNum + nextNum;
					System.out.println(nextNum + 1000);
				}else if(formulaArrayValues[i + 1].equals("-")){
					System.out.println("YES");
					nextNum = currentNum - nextNum;
				}else if(formulaArrayValues[i + 1].equals("*")){
					System.out.println("YES");
					System.out.println(nextNum + 1000);

					nextNum = currentNum * nextNum;
				}else if(formulaArrayValues[i + 1].equals("/")){
					nextNum = currentNum / nextNum;
				}
			}
		}else{
			return Double.parseDouble(formulaArrayValues[1]);
		}
		return nextNum;
	}
}