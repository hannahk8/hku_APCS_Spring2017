package textExcel;

public class FormulaCell extends RealCell{
	private String formulaValue;

	public FormulaCell(String formula) {
		setCellText(formula);
		this.formulaValue = getCellText();
	}
	
	public String abbreviatedTextCell(){
		return this.formulaValue.substring(0, 10);
	}
	
	public String fullCellText(){
		return Double.toString(getDoubleValue());
	}
	
	public double getDoubleValue(){
		System.out.println("hi");
		String[] formulaArrayValues = formulaValue.split(" ");
		double nextNum = 0.0;
		for(int i = 1; i < formulaArrayValues.length; i += 2){
			double currentNum = Double.parseDouble(formulaArrayValues[i]);
			nextNum = Double.parseDouble(formulaArrayValues[i + 2]);
			
			if(formulaArrayValues[i + 1].equals("+")){
				nextNum = currentNum + nextNum;
			}else if(formulaArrayValues[i + 1].equals("-")){
				nextNum = currentNum - nextNum;
			}else if(formulaArrayValues[i + 1].equals("*")){
				nextNum = currentNum * nextNum;
			}else if(formulaArrayValues[i + 1].equals("/")){
				nextNum = currentNum / nextNum;
			}
		}
		
		return nextNum;
	}
}
