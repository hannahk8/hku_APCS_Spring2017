package textExcel;

public class ValueCell extends RealCell {
	private String stringDouble;
	private String noSpacesStringDouble;
	private String unchanged;
		
	public ValueCell(String doubleNum) {
		this.stringDouble = doubleNum;
		this.noSpacesStringDouble = doubleNum;
		unchanged = doubleNum;
	}
	
	public String abbreviatedCellText() {
		if(this.stringDouble.length() > 10){
			return this.stringDouble.substring(0,10);
		}
		if(this.stringDouble.length() < 10){
			if(stringDouble.contains(".")){
				int decimalIndex = stringDouble.indexOf(".");
				String stringnumAfterDecimal = stringDouble.substring(decimalIndex);
				double numbersAfterDecimal = Double.parseDouble(stringnumAfterDecimal);
				if(numbersAfterDecimal != 0.0 && stringDouble.substring(stringDouble.length()-1).equals("0")){
					int count = 0;
					while(!(stringnumAfterDecimal.charAt(count) == '0' && stringnumAfterDecimal.charAt(count + 1) == '0')){
						count ++;
					}
					stringDouble = stringDouble.substring(0, (decimalIndex + 2) + (3));
				}else{
					stringDouble = stringDouble.substring(0, decimalIndex + 2);
				}
				/*if(numbersAfterDecimal == 0.0){
					stringDouble = stringDouble.substring(0, decimalIndex + 2);
				}*/
			}else{
				stringDouble += ".0";
			}
			int difference = 10 - this.stringDouble.length();
			for(int k = 0; k < difference; k++){
				stringDouble += " ";
			}
		}
			return this.stringDouble;
	}

	
	public String fullCellText(){
		return this.unchanged.replaceAll("\"", "") + "";
	}
	
	public double getDoubleValue(){
		return Double.parseDouble(this.stringDouble);
	}

}
